# 楓之谷自動化腳本 (C# WinForms)

**作者：** SchwarzeKatze_R

**版本：** 1.1.0

**開發語言：** C# (.NET 8, WinForms)

## 📖 專案簡介

基於 C# 開發的楓之谷鍵盤自動化工具，透過 **Windows API (P/Invoke)** 實現按鍵錄製、播放與背景發送，支援前景 / 背景雙模式。

## 專案介面
<img width="678" height="628" alt="image" src="https://github.com/user-attachments/assets/994d7641-b3c9-466a-a4cc-1b068e25d4b0" />

## ⚡ 功能特色

### 核心功能
* **錄製與播放：** 全域鍵盤鉤子精確擷取按鍵動作與時間間隔
* **腳本化：** 動作序列儲存為 `.mscript`（JSON），支援分享、載入與手動編輯
* **視窗鎖定：** 關鍵字搜尋或從清單手動選取目標視窗（顯示 32/64-bit 架構）

### 雙模式支援
* **前景模式：** `SendInput` API 模擬物理按鍵
* **背景模式：** `PostMessage` + `AttachThreadInput` 發送至指定視窗

### ⌨️ 方向鍵發送模式（三種可選）
| 模式 | 說明 |
|------|------|
| **S2C** | ThreadAttach + PostMessage，背景嘗試可控制對話框用 |
| **TAB** | ThreadAttach + Blocker，嘗試避免影響前景，但沒辦法杜絕 |
| **SWB** | SendInput + Blocker，嘗試避免影響前景，但沒辦法杜絕 |

### 自定義按鍵系統（15 格）
* 腳本播放時按間隔自動觸發技能 / 道具等按鍵
* 支援：間隔秒數、開始時間、觸發前暫停腳本、按鍵後延遲
* 設定隨腳本檔 `.mscript` 一起保存

### 其他功能
* **全局熱鍵：** F9 播放 / F10 停止（可自訂）
* **定時執行：** 指定時間自動開始播放，即時倒數顯示
* **執行統計：** 循環次數、自定義按鍵觸發次數等數據
* **輸入方式診斷：** PE Import Table 掃描 + 模組檢查 + 實驗測試
* **設定管理：** 自動儲存/載入，支援匯入/匯出（`%AppData%\MapleMacro\settings.json`）

## 🛠️ 環境需求

* **作業系統：** Windows 10 / 11
* **執行環境：** [.NET 8 Runtime (Windows)](https://dotnet.microsoft.com/download/dotnet/8.0)
* **權限要求：** 必須以**系統管理員身分**執行

## ▶️ 操作說明

1. **管理員權限啟動** → 右鍵「以系統管理員身分執行」
2. **鎖定遊戲視窗** → 「重新整理視窗」自動搜尋，或「鎖定視窗」手動選取（雙擊快速選擇）
3. **錄製** → 「開始錄製」後操作鍵盤，完成後可「編輯事件」微調
4. **自定義按鍵**（可選）→ 設定週期性技能按鍵的間隔與延遲參數
5. **播放** → 設定循環次數，按「開始播放」或 F9；按 F10 停止
6. **進階** → 熱鍵設定、方向鍵模式、定時執行、統計、輸入方式診斷

## 🐛 已知限制

* 背景模式下方向鍵使用 `AttachThreadInput` 會影響前景視窗的鍵盤狀態
* 背景模式下 Alt 鍵可能不穩定
* 錄製時切換視窗可能擷取到非預期的系統按鍵

## ⚠️ 重要聲明

* 本工具僅供**技術研究與個人學習**之用
* 使用自動化腳本可能違反遊戲服務條款，使用者需自負一切後果

## 📄 授權

[MIT License](https://github.com/kuroneko11375/MapleMacro-Ver.C-/blob/master/LICENSE.txt)





